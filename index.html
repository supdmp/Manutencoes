<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciador de ManutenÃ§Ãµes</title>
    <link rel="stylesheet" href="styles.css">
    <script>
        // Verificar autenticaÃ§Ã£o ANTES de carregar a pÃ¡gina
        (function () {
            const loggedUser = localStorage.getItem('loggedUser') || sessionStorage.getItem('loggedUser');
            if (!loggedUser) {
                window.location.href = 'login.html';
            }
        })();
    </script>
</head>

<body>
    <div class="container">
        <header>
            <div
                style="display: flex; justify-content: space-between; align-items: center; max-width: 1400px; margin: 0 auto; padding: 0 20px;">
                <div style="flex: 1;">
                    <h1>ðŸ“‹ Gerenciador de ManutenÃ§Ãµes</h1>
                    <p class="subtitle">Sistema de cadastro e acompanhamento de manutenÃ§Ãµes</p>
                </div>
                <div style="display: flex; align-items: center; gap: 20px;">
                    <span style="color: white; font-size: 0.95rem;">
                        ðŸ‘¤ UsuÃ¡rio: <strong id="nomeUsuario"></strong>
                    </span>
                    <button class="btn" onclick="logout()"
                        style="background: rgba(255,255,255,0.2); color: white; border: 2px solid white; padding: 10px 20px; cursor: pointer; border-radius: 10px;">
                        ðŸšª Sair
                    </button>
                </div>
            </div>
        </header>

        <div class="main-content" id="mainContent">
            <!-- Barra de Busca -->
            <div class="search-bar">
                <input type="text" id="searchInput" placeholder="Buscar por RazÃ£o Social ou CNPJ">
                <button id="searchBtn" class="btn btn-search-purple">Pesquisar</button>
                <button id="addButton" class="btn btn-success">
                    âž• Nova Empresa
                </button>
                <button id="reportButton" class="btn btn-info" onclick="window.location.href='relatorios.html'">
                    ðŸ“Š RelatÃ³rios
                </button>
            </div>

            <!-- Cards de EstatÃ­sticas -->
            <div class="stats">
                <div class="stat-card stat-completed" id="completedCard" onclick="filterData('completed')">
                    <div class="stat-value" id="completedCount">0</div>
                    <div class="stat-label">Atendidas</div>
                </div>
                <div class="stat-card stat-pending" id="pendingCard" onclick="filterData('pending')">
                    <div class="stat-value" id="pendingCount">0</div>
                    <div class="stat-label">Pendentes</div>
                </div>

                <div class="stat-card stat-total active" id="totalCard" onclick="filterData('all')">
                    <div class="stat-value" id="totalCount">0</div>
                    <div class="stat-label">Todas</div>
                </div>
            </div>

            <div id="loadingIndicator" class="loading">
                <div class="spinner"></div>
                <p>Carregando dados...</p>
            </div>

            <!-- Tabela -->
            <div class="table-container">
                <table id="dataTable">
                    <thead>
                        <tr>
                            <th>RazÃ£o Social</th>
                            <th>CNPJ</th>
                            <th>MÃªs da ManutenÃ§Ã£o</th>
                            <th>Status</th>
                            <th>AÃ§Ãµes</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Modal para adicionar/editar -->
        <div id="modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="modalTitle">Nova Empresa</h2>
                    <span class="close">&times;</span>
                </div>
                <form id="maintenanceForm">
                    <div class="form-group">
                        <label for="razaoSocial">RazÃ£o Social *</label>
                        <input type="text" id="razaoSocial" name="razaoSocial" required>
                    </div>
                    <div class="form-group">
                        <label for="cnpj">CNPJ *</label>
                        <input type="text" id="cnpj" name="cnpj" placeholder="00.000.000/0000-00" required
                            maxlength="18">
                    </div>

                    <!-- Campos apenas para ediÃ§Ã£o -->
                    <div id="editFields" style="display: none;">
                        <div class="form-group">
                            <label for="tecnico">TÃ©cnico *</label>
                            <input type="text" id="tecnico" name="tecnico" readonly style="background: #f5f5f5;">
                        </div>
                        <div class="form-group">
                            <label for="dataAtendimento">Data de Atendimento *</label>
                            <input type="date" id="dataAtendimento" name="dataAtendimento">
                        </div>
                        <div class="form-group">
                            <label for="acompanhadoPor">Acompanhado Por *</label>
                            <input type="text" id="acompanhadoPor" name="acompanhadoPor">
                        </div>
                        <div class="form-group">
                            <label for="observacoes">ObservaÃ§Ãµes (Opcional)</label>
                            <textarea id="observacoes" name="observacoes" rows="3"
                                style="width: 100%; padding: 10px; border: 2px solid #dadce0; border-radius: 10px; resize: vertical;"></textarea>
                        </div>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-outline" id="cancelButton">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Salvar</button>
                    </div>
                </form>
                <div id="modalLoading" class="modal-loading">
                    <div class="spinner"></div>
                    <p>Salvando alteraÃ§Ã£o...</p>
                </div>
            </div>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="script.js"></script>
</body>

</html>